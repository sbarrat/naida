<? /*Fichero busvent.phpConsideraciones en la busqueda del producto que queremos vender:		Si ponemos la referencia nuestra en principio no pondremos nada mas y si se pone pasamos		Si ponemos la referencia del proveedor no necesitamos poner nada mas y si se pone pasamos		Si se pone algo en la descripcion las referencias las podemos necesitar aunque sea parcialmente		Si ponemos familia talla o color las demas pueden servir de algo, aunque habra que considerar cuales estan vacias		y cuales no		asi que para todas estas cosas es mejor crear un fichero aparte que contemple todas estas consideraciones y devuelva resbu		que sera la cadena de busqueda. al fichero lo llamare busvent.php		tenemos como valores que llegan		$referencia		$referenciap		$descripcion		$escogido		$talla		$color		$familiaIMPORTANTISIMO: Si el resultado de la consulta solo es uno, lo metemos directamente en la venta si sin mas a la lista*///Generamos la consulta como en la primera parteif ($referencia != NULL){$param++;$chiv=0;$cadena[0] = "p.referencia like '%$referencia%'";}if ($referenciap != NULL){$param++;$chiv=1;$cadena[1] = "p.referenciap like '%$referenciap%'";}if ($descripcion != NULL){$param++;$chiv=2;$cadena[2]= "p.descripcion like '%$descripcion%'";}if ($talla != 0){$param++;$chiv=3;$cadena[3]= "p.talla like '$talla'";}if ($color != 0){$param++;$chiv=4;$cadena[4]="p.color like '$color'";}if ($familia != 0){$param++;$chiv=5;$cadena[5]="p.familia like '$familia'";}/*********************/if ($param != 0){	$consulta = "select p.stock as stock, p.id as pid, p.ano,p.temporada, p.descripcion, p.preciov, p.familia, p.talla, p.color, p.referenciap as rprov, p.referencia, t.id, t.nombre as ntalla, c.nombre as ncolor, f.nombre as fcolor from productos as p join tallas as t on p.talla = t.id join color as c on p.color = c.id join familias as f on p.familia = f.id where ";	if ($param == 1)	{	$consulta .= $cadena[$chiv];	}	else	{			$primer=0;			for ($i=0;$i<=5;$i++)			{								if(isset($cadena[$i]))								{										if($primer == 0)					{										$consulta .= $cadena[$i];					}					else					{					$consulta .= " and ";						$consulta .= $cadena[$i];					}					$primer=1;				}			}	}$resbu = $consulta;}?>	